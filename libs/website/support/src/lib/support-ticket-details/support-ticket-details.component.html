<div class="p-grid">
  <div class="p-col-10 p-offset-1 p-md-10 p-md-offset-1 p-lg-8 p-lg-offset-2">
    <div class="thread p-card p-p-5 p-mt-5 p-mb-5">
      
      <ng-template #loadingIndicator>
        <progress-spinner></progress-spinner>
      </ng-template>

      <div routerLink="../" style="cursor: pointer;">
        <i class="pi pi-angle-left p-mr-1"
        style="font-size: 1rem;"></i> Back to List
      </div>
      <br/>

      <div *ngIf="selectedSupportTicket$ | async as ticket; else loadingIndicator">
        <div class="p-grid">
          <div class="p-col-12 p-md-6 p-lg-12">
            <p>Ticket Reference ID: #{{ ticket.id }}</p>
          </div>
          <div class="p-col-12 p-md-6 p-lg-3">
            <i class="pi pi-clock p-mr-1"
              style="font-size: 1rem;"></i>
            {{ ticket.createdAt | date: 'dd MMM yyyy h:mm:ss' }}
          </div>
          <div class="p-col-12 p-md-6 p-lg-3">
            <p style="margin: 0;">{{ ticket.title }}</p>
          </div>
          <div class="p-col-12 p-md-6 p-lg-3">
            Category: {{ ticket.category }}
          </div>
          <div class="p-col-12 p-md-6 p-lg-3">
            Status: {{ ticket.isClosed ? 'Closed' : ticket.inProgress ? 'In Progress' : 'Open' }}
          </div>
        </div>
        <hr />
        <div *ngFor="let message of ticket.messages">
          <div class="p-grid p-mt-3 message-container">
            <div class="p-col-12 p-md-6 p-lg-6">
              <i class="pi pi-user p-mr-1"
                style="font-size: 1rem; display: inline;"></i>
              <p style="margin: 0; display: inline;">{{ message.name }} {{ message.isAdmin? '(Admin)' : '' }}</p>
            </div>
            <div class="p-col-12 p-md-6 p-lg-6">
              <i class="pi pi-clock p-mr-1"
                style="font-size: 1rem;"></i>
              {{ message.createdAt | date: 'dd MMM yyyy h:mm:ss' }}
            </div>
            <div class="p-col-12 p-md-12 p-lg-12">
              <p style="margin: 0;">{{ message.message }}</p>
            </div>
          </div>
        </div>
        <div *ngIf="!ticket.isClosed" class="p-col-12 p-mt-5 comment-box">
          <textarea [(ngModel)]="comment" class="comment-input" placeholder="Add ticket message"></textarea>
          <button (click)="addTicketMessage()" class="comment-button" type="button" pButton icon="pi pi-comment"></button>
      </div>
      </div>
    </div>
  </div>
</div>
