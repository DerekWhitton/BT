<div class="p-grid bg-white bt-all-caps p-text-left" *ngIf="query">
  <div class="p-col-10 p-offset-1 p-md-10 p-md-offset-1 p-lg-8 p-lg-offset-2">
    <div class="p-grid p-mt-1 p-mb-1">
      <div class="p-col-12">
        <ng-container *ngIf="searchResponse; else noSearchResponseHeader">
          <h3 *ngIf="searchResponse.items && searchResponse.items.length < 1">
            No Search Results were found for "{{ query }}", try another term, or
            select a category.
          </h3>
          <h3 *ngIf="searchResponse.items && searchResponse.items.length > 0">
            {{ searchResponse.items.length }} Results for "{{ query }}"
          </h3>
        </ng-container>

        <ng-template #noSearchResponseHeader>
          <h3>Searching for {{ query }}</h3>
        </ng-template>
      </div>
    </div>
  </div>
</div>

<div class="p-grid">
  <ng-template #noSearchResponse>
    <div class="p-col-12 p-text-center">
      <progress-spinner></progress-spinner>
    </div>
  </ng-template>

  <div
    class="p-col-10 p-offset-1 p-md-10 p-md-offset-1 p-lg-8 p-lg-offset-2"
    *ngIf="searchResponse; else noSearchResponse"
  >
    <div class="p-grid">
      <div class="p-col-12 p-mb-4">
        <h3 class="p-text-center">
          Browse <ng-container *ngIf="type == 0">auctions</ng-container>
          <ng-container *ngIf="type == 1">the marketplace</ng-container> by
          category
        </h3>
        <div class="p-d-flex p-jc-evenly p-flex-wrap">
          <div
            class="p-mr-2 p-mb-2 p-text-center category-button"
            *ngFor="let category of featuredCategories"
            (click)="handleCategorySelection(category.id)"
            [ngClass]="categoryId == category.id ? 'selected-category' : ''"
          >
            <div class="category-icon">
              <img
                *ngIf="category.categoryIconUri"
                src="{{ category.categoryIconUri }}"
              />
              <img
                *ngIf="!category.categoryIconUri"
                src="assets/layout/images/cat-000.png"
              />
              <span>{{ category.name }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="p-md-12 p-lg-3 sidebar">
        <p>
          {{ searchResponse?.items.length * searchResponse?.page }}/{{
            searchResponse?.totalItems
          }}
          items
        </p>

        <h4>
          Categories
          <span *ngIf="parentCategory != ''" style="float: right;"
            ><a (click)="getParentCategory()"> Back</a></span
          >
        </h4>

        <ul class="category-list">
          <li *ngFor="let category of subCategories">
            <a (click)="changeSubCategory(category.id)">{{ category.name }}</a>
          </li>

          <li *ngIf="parentCategory != ''">
            <a (click)="getParentCategory()">Back</a>
          </li>
        </ul>

        <hr />
        <h4 class="p-pt-0 p-mt-1">
          PRICE
        </h4>
        <div class="p-grid">
          <div class="p-col">
            <div class="p-mb-2" *ngIf="searchPriceRange">
              {{ searchPriceRange[0] + ' - ' + searchPriceRange[1] }}
            </div>
            <p-slider
              [(ngModel)]="searchPriceRange"
              [range]="true"
              [step]="100"
              [min]="0"
              [max]="maxPrice"
              (onSlideEnd)="navigate()"
            ></p-slider>
          </div>
        </div>
        <bushtrade-search-facet
          [facet]="facet"
          *ngFor="let facet of facetsResponse"
          [selectedFacets]="facets"
          (facetSelected)="handleFacetSelection($event)"
        ></bushtrade-search-facet>
      </div>

      <div class="p-md-12 p-lg-9">
        <div class="p-grid">
          <ng-container *ngIf="searchResponse?.items.length > 0; else noItems">
            <bushtrade-web-product-item
              class="p-mb-4 p-col-12"
              *ngFor="let item of searchResponse.items"
              [item]="item"
            ></bushtrade-web-product-item>
          </ng-container>

          <ng-template #noItems>
            <div>
              <h3>
                There are currently no listings for this category
                <ng-container *ngIf="type == 0">in auctions</ng-container>
                <ng-container *ngIf="type == 1">in the marketplace</ng-container
                >.
              </h3>
              <p *ngIf="type">
                Try adjusting your price range, filter or check for more results
                on
                <a *ngIf="type == 1" (click)="changeType(0)">auctions</a>
                <a *ngIf="type == 0" (click)="changeType(1)">the marketplace</a>
              </p>
              <p *ngIf="!type">
                Try adjusting your price range and filters
              </p>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</div>
